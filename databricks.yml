# Databricks Asset Bundles Configuration
# E-Commerce Analytics Platform
# ================================

bundle:
  name: ecommerce-analytics-platform

# Include resource definitions
include:
  - resources/*.yml

# Workspace configuration
workspace:
  host: ${var.databricks_host}

# Variables used across all targets
variables:
  databricks_host:
    description: "Databricks workspace URL"
    default: ""
  catalog_name:
    description: "Unity Catalog name for this environment"
  schema_bronze:
    description: "Bronze layer schema name"
    default: "bronze_layer"
  schema_silver:
    description: "Silver layer schema name"
    default: "silver_layer"
  schema_gold:
    description: "Gold layer schema name"
    default: "gold_layer"
  volume_raw_data:
    description: "Volume path for raw CSV data"
  warehouse_id:
    description: "SQL Warehouse ID for queries"
    default: ""

# Environment-specific targets
targets:
  # Development environment
  dev:
    mode: development
    default: true
    variables:
      catalog_name: ecommerce_analytics_dev
      volume_raw_data: /Volumes/ecommerce_analytics_dev/bronze_layer/raw_data
    workspace:
      host: ${var.databricks_host}
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/dev

  # Staging environment
  staging:
    mode: development
    variables:
      catalog_name: ecommerce_analytics_staging
      volume_raw_data: /Volumes/ecommerce_analytics_staging/bronze_layer/raw_data
    workspace:
      host: ${var.databricks_host}
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/staging

  # Production environment
  prod:
    mode: production
    variables:
      catalog_name: ecommerce_analytics_prod
      volume_raw_data: /Volumes/ecommerce_analytics_prod/bronze_layer/raw_data
    workspace:
      host: ${var.databricks_host}
      root_path: /Workspace/Shared/.bundle/${bundle.name}/prod
    run_as:
      # Uncomment and configure for production service principal
      # service_principal_name: "ecommerce-analytics-sp"
      user_name: ${workspace.current_user.userName}
